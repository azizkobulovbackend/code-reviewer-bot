name: Telegram Commit Notifier

on:
  push:
    branches:
      - main

jobs:
  notify:
    runs-on: ubuntu-latest

    steps:
      - name: Send commit info to Telegram
        run: |
          MESSAGE="<b>ğŸ“¦ New commit pushed</b>%0A\
          ğŸ‘¤ <b>Author:</b> ${{ github.actor }}%0A\
          ğŸ“ <b>Message:</b> ${{ github.event.head_commit.message }}%0A\
          ğŸ”‘ <b>Commit:</b> <code>${{ github.sha }}</code>%0A\
          ğŸ”— <a href='https://github.com/${{ github.repository }}/commit/${{ github.sha }}'>View commit</a>"

          curl -s -X POST "https://api.telegram.org/bot${{ secrets.BOT_TOKEN }}/sendMessage" \
            -d chat_id="${{ secrets.CHANNEL_ID }}" \
            -d parse_mode=HTML \
            -d text="$MESSAGE"
